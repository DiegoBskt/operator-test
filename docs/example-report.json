{
  "metadata": {
    "generatedAt": "2024-01-15T10:30:00Z",
    "assessmentName": "production-assessment",
    "profile": "production",
    "operatorVersion": "1.0.0"
  },
  "clusterInfo": {
    "clusterID": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
    "clusterVersion": "4.14.8",
    "platform": "AWS",
    "channel": "stable-4.14",
    "nodeCount": 9,
    "controlPlaneNodes": 3,
    "workerNodes": 6
  },
  "summary": {
    "totalChecks": 35,
    "passCount": 25,
    "warnCount": 7,
    "failCount": 2,
    "infoCount": 1,
    "score": 78,
    "profileUsed": "production"
  },
  "findings": [
    {
      "id": "version-current",
      "validator": "version",
      "category": "Platform",
      "status": "INFO",
      "title": "OpenShift Version",
      "description": "Cluster is running OpenShift version 4.14.8",
      "references": [
        "https://access.redhat.com/support/policy/updates/openshift"
      ]
    },
    {
      "id": "version-channel",
      "validator": "version",
      "category": "Platform",
      "status": "PASS",
      "title": "Upgrade Channel Configuration",
      "description": "Cluster is configured with upgrade channel: stable-4.14"
    },
    {
      "id": "version-updates-available",
      "validator": "version",
      "category": "Platform",
      "status": "WARN",
      "title": "Updates Available",
      "description": "Updates available: 4.14.9, 4.14.10",
      "impact": "Running an older version may mean missing security patches and bug fixes.",
      "recommendation": "Review available updates and plan an upgrade during a maintenance window."
    },
    {
      "id": "nodes-control-plane-count",
      "validator": "nodes",
      "category": "Infrastructure",
      "status": "PASS",
      "title": "Control Plane Node Count",
      "description": "Cluster has 3 control plane nodes, meeting the minimum of 3."
    },
    {
      "id": "nodes-worker-count",
      "validator": "nodes",
      "category": "Infrastructure",
      "status": "PASS",
      "title": "Worker Node Count",
      "description": "Cluster has 6 worker nodes, meeting the minimum of 3."
    },
    {
      "id": "nodes-ready",
      "validator": "nodes",
      "category": "Infrastructure",
      "status": "PASS",
      "title": "All Nodes Ready",
      "description": "All 9 nodes are in Ready state."
    },
    {
      "id": "nodes-os-consistent",
      "validator": "nodes",
      "category": "Infrastructure",
      "status": "PASS",
      "title": "Consistent Node OS",
      "description": "All nodes are running: Red Hat Enterprise Linux CoreOS 414.92.202401091202-0"
    },
    {
      "id": "security-cluster-admin-excessive",
      "validator": "security",
      "category": "Security",
      "status": "WARN",
      "title": "Excessive Non-System Cluster-Admin Bindings",
      "description": "Found 8 non-system cluster-admin bindings (threshold: 5): admin-team-binding (Group: admin-team), dev-lead-binding (User: dev-lead@company.com), ...",
      "impact": "Excessive cluster-admin permissions increase the attack surface and risk of privilege escalation.",
      "recommendation": "Review cluster-admin bindings and apply least privilege principle. Consider using more specific ClusterRoles.",
      "references": [
        "https://docs.openshift.com/container-platform/latest/authentication/using-rbac.html"
      ]
    },
    {
      "id": "security-privileged-pods",
      "validator": "security",
      "category": "Security",
      "status": "WARN",
      "title": "Privileged Containers in User Namespaces",
      "description": "Found 3 pod(s) with privileged containers in user namespaces: myapp/debug-pod, monitoring/custom-exporter, logging/fluentd-custom...",
      "impact": "Privileged containers have elevated access to the host and bypass many security controls.",
      "recommendation": "Review if privileged access is necessary. Consider using specific capabilities instead of full privileged mode."
    },
    {
      "id": "storage-default-sc",
      "validator": "storage",
      "category": "Storage",
      "status": "PASS",
      "title": "Default StorageClass Configured",
      "description": "Default StorageClass: gp3-csi (provisioner: ebs.csi.aws.com)"
    },
    {
      "id": "storage-csi-supported",
      "validator": "storage",
      "category": "Storage",
      "status": "PASS",
      "title": "Supported CSI Drivers",
      "description": "Found 2 known/supported CSI driver(s): ebs.csi.aws.com, efs.csi.aws.com"
    },
    {
      "id": "networking-supported-type",
      "validator": "networking",
      "category": "Networking",
      "status": "PASS",
      "title": "Supported Network Type",
      "description": "Cluster is using supported OVNKubernetes networking."
    },
    {
      "id": "networking-policies-found",
      "validator": "networking",
      "category": "Networking",
      "status": "PASS",
      "title": "NetworkPolicies Configured",
      "description": "Found 42 NetworkPolicy(ies) across 15 namespace(s)."
    },
    {
      "id": "machineconfig-mcp-healthy",
      "validator": "machineconfig",
      "category": "Platform",
      "status": "PASS",
      "title": "Healthy MachineConfigPools",
      "description": "3 MachineConfigPool(s) are healthy: master, worker, infra"
    },
    {
      "id": "machineconfig-custom",
      "validator": "machineconfig",
      "category": "Platform",
      "status": "WARN",
      "title": "Custom MachineConfigs",
      "description": "Found 2 custom MachineConfig(s): 99-worker-chrony, 99-master-chrony",
      "impact": "Custom MachineConfigs modify node configuration and should be reviewed for supportability.",
      "recommendation": "Ensure custom MachineConfigs are documented and aligned with Red Hat support policies."
    },
    {
      "id": "monitoring-operator-healthy",
      "validator": "monitoring",
      "category": "Observability",
      "status": "PASS",
      "title": "Monitoring Operator Healthy",
      "description": "The monitoring ClusterOperator is available and not degraded."
    },
    {
      "id": "monitoring-no-persistent-storage",
      "validator": "monitoring",
      "category": "Observability",
      "status": "WARN",
      "title": "No Persistent Storage for Monitoring",
      "description": "Monitoring configuration does not appear to include persistent storage.",
      "impact": "Metrics data will be lost when Prometheus pods restart.",
      "recommendation": "Configure persistent storage for Prometheus to retain metrics across restarts."
    },
    {
      "id": "monitoring-user-workload-enabled",
      "validator": "monitoring",
      "category": "Observability",
      "status": "PASS",
      "title": "User Workload Monitoring Configured",
      "description": "User workload monitoring is configured."
    },
    {
      "id": "deprecation-no-probes",
      "validator": "deprecation",
      "category": "Compatibility",
      "status": "WARN",
      "title": "Containers Without Health Probes",
      "description": "Found 12 container(s) without liveness or readiness probes: myapp/api-server:main, myapp/worker:main, ...",
      "impact": "Containers without probes may not be properly managed during failures or updates.",
      "recommendation": "Configure appropriate liveness and readiness probes for all containers."
    },
    {
      "id": "deprecation-no-resources",
      "validator": "deprecation",
      "category": "Compatibility",
      "status": "FAIL",
      "title": "Containers Without Resource Requests/Limits",
      "description": "Found 8 container(s) without resource requests or limits: batch/job-processor:main, testing/load-test:runner, ...",
      "impact": "Containers without resource specifications may cause resource contention.",
      "recommendation": "Configure appropriate resource requests and limits for all containers."
    }
  ],
  "findingsByCategory": {
    "Platform": [
      {"id": "version-current", "status": "INFO"},
      {"id": "version-channel", "status": "PASS"},
      {"id": "version-updates-available", "status": "WARN"},
      {"id": "machineconfig-mcp-healthy", "status": "PASS"},
      {"id": "machineconfig-custom", "status": "WARN"}
    ],
    "Infrastructure": [
      {"id": "nodes-control-plane-count", "status": "PASS"},
      {"id": "nodes-worker-count", "status": "PASS"},
      {"id": "nodes-ready", "status": "PASS"},
      {"id": "nodes-os-consistent", "status": "PASS"}
    ],
    "Security": [
      {"id": "security-cluster-admin-excessive", "status": "WARN"},
      {"id": "security-privileged-pods", "status": "WARN"}
    ],
    "Storage": [
      {"id": "storage-default-sc", "status": "PASS"},
      {"id": "storage-csi-supported", "status": "PASS"}
    ],
    "Networking": [
      {"id": "networking-supported-type", "status": "PASS"},
      {"id": "networking-policies-found", "status": "PASS"}
    ],
    "Observability": [
      {"id": "monitoring-operator-healthy", "status": "PASS"},
      {"id": "monitoring-no-persistent-storage", "status": "WARN"},
      {"id": "monitoring-user-workload-enabled", "status": "PASS"}
    ],
    "Compatibility": [
      {"id": "deprecation-no-probes", "status": "WARN"},
      {"id": "deprecation-no-resources", "status": "FAIL"}
    ]
  },
  "findingsByStatus": {
    "PASS": 14,
    "WARN": 7,
    "FAIL": 1,
    "INFO": 1
  }
}
